<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoQuest - City Location Game</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin="" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1200px;
            width: 100%;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .setup-screen, .game-screen {
            padding: 40px;
        }

        .setup-screen textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #667eea;
            border-radius: 10px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
        }

        .setup-screen label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
        }

        .setup-screen button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s;
        }

        .setup-screen button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .game-info div {
            text-align: center;
        }

        .game-info .label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .game-info .value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .current-city {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            font-size: 24px;
            font-weight: bold;
        }

        .map-container {
            position: relative;
            width: 100%;
            height: 500px;
            border: 3px solid #667eea;
            border-radius: 10px;
            overflow: hidden;
        }

        #map {
            width: 100%;
            height: 100%;
            cursor: crosshair;
        }

        .feedback {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            border-radius: 10px;
            font-size: 20px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .feedback.show {
            opacity: 1;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        .next-button {
            display: block;
            margin: 20px auto 0;
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .next-button:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .results-screen {
            padding: 40px;
            text-align: center;
        }

        .results-screen h2 {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 30px;
        }

        .final-score {
            font-size: 4em;
            color: #27ae60;
            margin: 20px 0;
        }

        .results-details {
            margin: 30px 0;
            text-align: left;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .result-item {
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-item .city-name {
            font-weight: bold;
            color: #333;
        }

        .result-item .score {
            font-size: 20px;
            color: #667eea;
            font-weight: bold;
        }

        .play-again {
            margin-top: 30px;
            padding: 15px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .play-again:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .hidden {
            display: none !important;
        }

        .instruction {
            text-align: center;
            color: #666;
            margin-bottom: 15px;
            font-style: italic;
        }

        .guess-marker {
            width: 20px;
            height: 20px;
            background: #f39c12;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(243, 156, 18, 0.6);
        }

        .correct-marker {
            width: 20px;
            height: 20px;
            background: #27ae60;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(39, 174, 96, 0.6);
            animation: pulse 1s ease-in-out;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.3);
            }
        }

        .leaflet-popup-content-wrapper {
            border-radius: 8px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .leaflet-popup-content {
            margin: 10px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç GeoQuest</h1>
            <p>Test your geography knowledge with a real world map!</p>
        </div>

        <!-- Setup Screen -->
        <div class="setup-screen hidden" id="setupScreen">
            <label>Enter cities you want to learn (one per line):</label>
            <textarea id="cityInput" placeholder="Enter city names...">Istanbul
New York
Chicago
Mexico City
Los Angeles
Rio de Janeiro
S√£o Paulo
Buenos Aires
Paris
London
Moscow
Cairo
Lagos
Tehran
Mumbai
Karachi
Delhi
Dhaka
Kolkata
Bangkok
Manila
Hong Kong
Shanghai
Beijing
Seoul
Osaka
Tokyo</textarea>
            <button onclick="startGame()">Start Game!</button>
        </div>

        <!-- Game Screen -->
        <div class="game-screen" id="gameScreen">
            <div class="game-info">
                <div>
                    <div class="label">Round</div>
                    <div class="value" id="roundNumber">1/10</div>
                </div>
                <div>
                    <div class="label">Score</div>
                    <div class="value" id="currentScore">0</div>
                </div>
                <div>
                    <div class="label">Total</div>
                    <div class="value" id="totalScore">0/1000</div>
                </div>
            </div>

            <div class="current-city">
                üìç Find: <span id="currentCity">Tokyo</span>
            </div>

            <div class="instruction">
                Click on the map to guess the location ‚Ä¢ Use zoom controls and drag to explore
            </div>

            <div class="map-container">
                <div id="map"></div>
            </div>

            <div class="feedback" id="feedback"></div>
            <button class="next-button hidden" id="nextButton" onclick="nextRound()">Next City ‚Üí</button>
        </div>

        <!-- Results Screen -->
        <div class="results-screen hidden" id="resultsScreen">
            <h2>üéâ Game Complete!</h2>
            <div class="final-score" id="finalScore">0</div>
            <div>out of 1000 points</div>
            <div class="results-details" id="resultsDetails"></div>
            <button class="play-again" onclick="resetGame()">Play Again</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <script>
        // Comprehensive city database with accurate coordinates
        const cityDatabase = {
            // Asia
            'Tokyo': { lat: 35.6895, lon: 139.6917, country: 'Japan' },
            'Beijing': { lat: 39.9042, lon: 116.4074, country: 'China' },
            'Shanghai': { lat: 31.2304, lon: 121.4737, country: 'China' },
            'Mumbai': { lat: 19.0760, lon: 72.8777, country: 'India' },
            'Delhi': { lat: 28.7041, lon: 77.1025, country: 'India' },
            'Dhaka': { lat: 23.8103, lon: 90.4125, country: 'Bangladesh' },
            'Kolkata': { lat: 22.5726, lon: 88.3639, country: 'India' },
            'Seoul': { lat: 37.5665, lon: 126.9780, country: 'South Korea' },
            'Bangkok': { lat: 13.7563, lon: 100.5018, country: 'Thailand' },
            'Singapore': { lat: 1.3521, lon: 103.8198, country: 'Singapore' },
            'Hong Kong': { lat: 22.3193, lon: 114.1694, country: 'China' },
            'Osaka': { lat: 34.6937, lon: 135.5022, country: 'Japan' },
            'Karachi': { lat: 24.8607, lon: 67.0099, country: 'Pakistan' },
            'Dubai': { lat: 25.2048, lon: 55.2708, country: 'UAE' },
            'Istanbul': { lat: 41.0082, lon: 28.9784, country: 'Turkey' },
            'Jakarta': { lat: -6.2088, lon: 106.8456, country: 'Indonesia' },
            'Tehran': { lat: 35.6944, lon: 51.4231, country: 'Iran' },
            'Manila': { lat: 14.5995, lon: 120.9842, country: 'Philippines' },
            'Taipei': { lat: 25.0330, lon: 121.5654, country: 'Taiwan' },
            'Kuala Lumpur': { lat: 3.1390, lon: 101.6869, country: 'Malaysia' },
            'Riyadh': { lat: 24.7136, lon: 46.6753, country: 'Saudi Arabia' },
            
            // Europe
            'London': { lat: 51.5074, lon: -0.1278, country: 'UK' },
            'Paris': { lat: 48.8566, lon: 2.3522, country: 'France' },
            'Berlin': { lat: 52.5200, lon: 13.4050, country: 'Germany' },
            'Madrid': { lat: 40.4168, lon: -3.7038, country: 'Spain' },
            'Rome': { lat: 41.9028, lon: 12.4964, country: 'Italy' },
            'Moscow': { lat: 55.7558, lon: 37.6173, country: 'Russia' },
            'Amsterdam': { lat: 52.3676, lon: 4.9041, country: 'Netherlands' },
            'Barcelona': { lat: 41.3851, lon: 2.1734, country: 'Spain' },
            'Vienna': { lat: 48.2082, lon: 16.3738, country: 'Austria' },
            'Athens': { lat: 37.9838, lon: 23.7275, country: 'Greece' },
            'Prague': { lat: 50.0755, lon: 14.4378, country: 'Czech Republic' },
            'Stockholm': { lat: 59.3293, lon: 18.0686, country: 'Sweden' },
            'Warsaw': { lat: 52.2297, lon: 21.0122, country: 'Poland' },
            'Brussels': { lat: 50.8503, lon: 4.3517, country: 'Belgium' },
            'Zurich': { lat: 47.3769, lon: 8.5417, country: 'Switzerland' },
            'Munich': { lat: 48.1351, lon: 11.5820, country: 'Germany' },
            'Milan': { lat: 45.4642, lon: 9.1900, country: 'Italy' },
            'Lisbon': { lat: 38.7223, lon: -9.1393, country: 'Portugal' },
            
            // North America
            'New York': { lat: 40.7128, lon: -74.0060, country: 'USA' },
            'Los Angeles': { lat: 34.0522, lon: -118.2437, country: 'USA' },
            'Chicago': { lat: 41.8781, lon: -87.6298, country: 'USA' },
            'Toronto': { lat: 43.6532, lon: -79.3832, country: 'Canada' },
            'Mexico City': { lat: 19.4326, lon: -99.1332, country: 'Mexico' },
            'Miami': { lat: 25.7617, lon: -80.1918, country: 'USA' },
            'San Francisco': { lat: 37.7749, lon: -122.4194, country: 'USA' },
            'Vancouver': { lat: 49.2827, lon: -123.1207, country: 'Canada' },
            'Montreal': { lat: 45.5017, lon: -73.5673, country: 'Canada' },
            'Houston': { lat: 29.7604, lon: -95.3698, country: 'USA' },
            'Seattle': { lat: 47.6062, lon: -122.3321, country: 'USA' },
            'Boston': { lat: 42.3601, lon: -71.0589, country: 'USA' },
            'Las Vegas': { lat: 36.1699, lon: -115.1398, country: 'USA' },
            
            // South America
            'S√£o Paulo': { lat: -23.5505, lon: -46.6333, country: 'Brazil' },
            'Rio de Janeiro': { lat: -22.9068, lon: -43.1729, country: 'Brazil' },
            'Buenos Aires': { lat: -34.6037, lon: -58.3816, country: 'Argentina' },
            'Lima': { lat: -12.0464, lon: -77.0428, country: 'Peru' },
            'Bogot√°': { lat: 4.7110, lon: -74.0721, country: 'Colombia' },
            'Santiago': { lat: -33.4489, lon: -70.6693, country: 'Chile' },
            'Caracas': { lat: 10.4806, lon: -66.9036, country: 'Venezuela' },
            'Quito': { lat: -0.1807, lon: -78.4678, country: 'Ecuador' },
            
            // Africa
            'Cairo': { lat: 30.0444, lon: 31.2357, country: 'Egypt' },
            'Lagos': { lat: 6.5244, lon: 3.3792, country: 'Nigeria' },
            'Johannesburg': { lat: -26.2041, lon: 28.0473, country: 'South Africa' },
            'Nairobi': { lat: -1.2921, lon: 36.8219, country: 'Kenya' },
            'Casablanca': { lat: 33.5731, lon: -7.6114, country: 'Morocco' },
            'Cape Town': { lat: -33.9249, lon: 18.4241, country: 'South Africa' },
            'Addis Ababa': { lat: 9.0320, lon: 38.7469, country: 'Ethiopia' },
            'Accra': { lat: 5.6037, lon: -0.1870, country: 'Ghana' },
            
            // Oceania
            'Sydney': { lat: -33.8688, lon: 151.2093, country: 'Australia' },
            'Melbourne': { lat: -37.8136, lon: 144.9631, country: 'Australia' },
            'Auckland': { lat: -36.8485, lon: 174.7633, country: 'New Zealand' },
            'Perth': { lat: -31.9505, lon: 115.8605, country: 'Australia' },
            'Brisbane': { lat: -27.4698, lon: 153.0251, country: 'Australia' }
        };

        // Game state
        let gameState = {
            cities: [],
            currentRound: 0,
            scores: [],
            totalScore: 0,
            hasGuessed: false,
            map: null,
            guessMarker: null,
            correctMarker: null,
            polyline: null
        };

        // Calculate distance between two points (in km) using Haversine formula
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                    Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        // Calculate score based on distance (max 100 points per city)
        function calculateScore(distance) {
            if (distance < 50) return 100;
            if (distance > 5000) return 0;
            return Math.round(100 - (distance / 5000) * 100);
        }

        // Sound effects
        function playSound(type) {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            if (type === 'correct') {
                oscillator.frequency.value = 523.25;
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
                
                setTimeout(() => {
                    const osc2 = audioContext.createOscillator();
                    const gain2 = audioContext.createGain();
                    osc2.connect(gain2);
                    gain2.connect(audioContext.destination);
                    osc2.frequency.value = 659.25;
                    gain2.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gain2.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    osc2.start(audioContext.currentTime);
                    osc2.stop(audioContext.currentTime + 0.5);
                }, 100);
            } else {
                oscillator.frequency.value = 311.13;
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.6);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.6);
            }
        }

        // Initialize the map
        function initMap() {
            if (gameState.map) {
                gameState.map.remove();
            }

            gameState.map = L.map('map', {
                center: [20, 0],
                zoom: 2,
                minZoom: 2,
                maxZoom: 10,
                worldCopyJump: true
            });

            // Use CartoDB Positron - shows borders but no city labels
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                subdomains: 'abcd',
                maxZoom: 10,
                noWrap: false
            }).addTo(gameState.map);

            // Handle map clicks
            gameState.map.on('click', function(e) {
                if (!gameState.hasGuessed) {
                    handleGuess(e.latlng.lat, e.latlng.lng);
                }
            });
        }

        // Start the game
        function startGame() {
            // Hardcoded city list - only these cities
            const cityList = [
                'Istanbul',
                'New York',
                'Chicago',
                'Mexico City',
                'Los Angeles',
                'Rio de Janeiro',
                'S√£o Paulo',
                'Buenos Aires',
                'Paris',
                'London',
                'Moscow',
                'Cairo',
                'Lagos',
                'Tehran',
                'Mumbai',
                'Karachi',
                'Delhi',
                'Dhaka',
                'Kolkata',
                'Bangkok',
                'Manila',
                'Hong Kong',
                'Shanghai',
                'Beijing',
                'Seoul',
                'Osaka',
                'Tokyo'
            ];

            // Shuffle and take 10 random cities
            gameState.cities = cityList
                .sort(() => Math.random() - 0.5)
                .slice(0, 10);
            
            gameState.currentRound = 0;
            gameState.scores = [];
            gameState.totalScore = 0;

            document.getElementById('setupScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            initMap();
            loadRound();
        }

        // Load current round
        function loadRound() {
            gameState.hasGuessed = false;
            document.getElementById('nextButton').classList.add('hidden');
            document.getElementById('feedback').classList.remove('show');
            
            // Clear previous markers
            if (gameState.guessMarker) {
                gameState.map.removeLayer(gameState.guessMarker);
            }
            if (gameState.correctMarker) {
                gameState.map.removeLayer(gameState.correctMarker);
            }
            if (gameState.polyline) {
                gameState.map.removeLayer(gameState.polyline);
            }

            // Reset map view
            gameState.map.setView([20, 0], 2);
            
            const cityName = gameState.cities[gameState.currentRound];
            document.getElementById('currentCity').textContent = cityName;
            document.getElementById('roundNumber').textContent = `${gameState.currentRound + 1}/10`;
            document.getElementById('currentScore').textContent = '0';
            document.getElementById('totalScore').textContent = `${gameState.totalScore}/1000`;
        }

        // Handle player's guess
        function handleGuess(guessLat, guessLon) {
            gameState.hasGuessed = true;
            
            const cityName = gameState.cities[gameState.currentRound];
            const cityData = cityDatabase[cityName];
            
            // Calculate distance and score
            const distance = calculateDistance(guessLat, guessLon, cityData.lat, cityData.lon);
            const score = calculateScore(distance);
            
            gameState.scores.push({ city: cityName, score, distance });
            gameState.totalScore += score;
            
            // Create custom marker icons
            const guessIcon = L.divIcon({
                className: 'guess-marker',
                iconSize: [20, 20],
                iconAnchor: [10, 10]
            });
            
            const correctIcon = L.divIcon({
                className: 'correct-marker',
                iconSize: [20, 20],
                iconAnchor: [10, 10]
            });
            
            // Add markers
            gameState.guessMarker = L.marker([guessLat, guessLon], {icon: guessIcon})
                .addTo(gameState.map)
                .bindPopup('Your guess')
                .openPopup();
            
            gameState.correctMarker = L.marker([cityData.lat, cityData.lon], {icon: correctIcon})
                .addTo(gameState.map)
                .bindPopup(`${cityName}<br>${cityData.country}`);
            
            // Draw line between guess and correct location
            gameState.polyline = L.polyline([
                [guessLat, guessLon],
                [cityData.lat, cityData.lon]
            ], {
                color: '#e74c3c',
                weight: 3,
                opacity: 0.7,
                dashArray: '10, 10'
            }).addTo(gameState.map);
            
            // Adjust map to show both markers
            const bounds = L.latLngBounds([
                [guessLat, guessLon],
                [cityData.lat, cityData.lon]
            ]);
            gameState.map.fitBounds(bounds, { padding: [50, 50] });
            
            // Show feedback
            const feedback = document.getElementById('feedback');
            if (score >= 90) {
                feedback.textContent = `üéØ Perfect! ${score} points! (${Math.round(distance)} km away)`;
                feedback.className = 'feedback correct show';
                playSound('correct');
            } else if (score >= 70) {
                feedback.textContent = `üëç Great! ${score} points! (${Math.round(distance)} km away)`;
                feedback.className = 'feedback correct show';
                playSound('correct');
            } else if (score >= 40) {
                feedback.textContent = `üëå Good try! ${score} points (${Math.round(distance)} km away)`;
                feedback.className = 'feedback incorrect show';
                playSound('incorrect');
            } else {
                feedback.textContent = `üìç Not quite! ${score} points (${Math.round(distance)} km away)`;
                feedback.className = 'feedback incorrect show';
                playSound('incorrect');
            }
            
            document.getElementById('currentScore').textContent = score;
            document.getElementById('totalScore').textContent = `${gameState.totalScore}/1000`;
            document.getElementById('nextButton').classList.remove('hidden');
        }

        // Next round
        function nextRound() {
            gameState.currentRound++;
            if (gameState.currentRound >= gameState.cities.length) {
                showResults();
            } else {
                loadRound();
            }
        }

        // Show final results
        function showResults() {
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');
            
            document.getElementById('finalScore').textContent = gameState.totalScore;
            
            const detailsDiv = document.getElementById('resultsDetails');
            detailsDiv.innerHTML = '<h3 style="margin-bottom: 20px;">Your Performance:</h3>';
            
            gameState.scores.forEach(item => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                resultItem.innerHTML = `
                    <span class="city-name">${item.city}</span>
                    <span class="score">${item.score} pts (${Math.round(item.distance)} km)</span>
                `;
                detailsDiv.appendChild(resultItem);
            });
            
            playSound('correct');
        }

        // Reset game
        function resetGame() {
            document.getElementById('resultsScreen').classList.add('hidden');
            document.getElementById('setupScreen').classList.remove('hidden');
            
            if (gameState.map) {
                gameState.map.remove();
                gameState.map = null;
            }
            
            // Restart the game
            startGame();
        }

        // Auto-start game on page load
        window.addEventListener('load', function() {
            startGame();
        });
    </script>
</body>
</html>